import{a as I,b as u,c as z,d as q,g as w,h as R,i as V,j as L,k as B,l as G,m as J,n as U,o as X,p as W,q as j,r as H,s as K,t as Y}from"./chunk-KG4FPA2W.js";import{f as A,h as Q}from"./chunk-E555E6H3.js";import{$ as x,$a as i,Ab as D,Bb as T,Ja as N,Na as v,Ta as p,Tb as O,Ua as f,V as S,Xb as k,Ya as y,Yb as M,Za as t,_ as g,_a as e,db as _,eb as s,gb as F,nb as n,pb as P,wa as d}from"./chunk-5DGU7OID.js";function $(l,o){l&1&&(t(0,"small",13),n(1,"CPO Date is required"),e())}function ee(l,o){l&1&&(t(0,"small",13),n(1,"Merchandiser is required"),e())}function te(l,o){l&1&&(t(0,"small",13),n(1,"Customer is required"),e())}function ne(l,o){l&1&&(t(0,"small",13),n(1,"Valid quantity required"),e())}function ie(l,o){l&1&&(t(0,"small",13),n(1,"Valid price required"),e())}function oe(l,o){l&1&&(t(0,"small",13),n(1,"Delivery Date is required"),e())}function re(l,o){if(l&1&&(t(0,"tr",86)(1,"td"),i(2,"input",87),e(),t(3,"td"),i(4,"input",88),e(),t(5,"td"),i(6,"input",89),e(),t(7,"td"),i(8,"input",90),e()()),l&2){let m=o.index;y("formGroupName",m)}}function le(l,o){if(l&1){let m=_();t(0,"tr",86)(1,"td"),i(2,"input",91),e(),t(3,"td"),i(4,"input",92),e(),t(5,"td",93)(6,"button",94),s("click",function(){let a=g(m).index,c=F();return x(c.removeProductionRow(a))}),i(7,"i",95),e()()()}if(l&2){let m=o.index;y("formGroupName",m)}}var Z=class l{fb=S(H);router=S(Q);route=S(A);isEditMode=!1;cpoId=null;orderTypes=["ANS","Repeat"];subOrderTypes=["Normal","Special"];seasons=["Summer","Winter"];currencies=["USD","EUR","PKR"];paymentTermsList=["L/C 120 Days","TT Advance","TT 60 Days"];incoterms=["FOB","CNF","CIF","Ex-Factory"];shipmentModes=["AIR","SEA","Courier"];deliveryTerms=["Full Shipment Allowed","Partial Shipment Allowed"];statusList=["Draft","Active","Completed","Cancelled"];sizesMaster=["XS","S","M","L","XL"];cpoForm=this.fb.group({cpoNo:[{value:"001/1225",disabled:!0},u.required],cpoDate:["",u.required],merchandiser:["",u.required],customer:["",u.required],orderType:["ANS"],subOrderType:["Normal"],season:[""],selection:[""],customerPoNo:[""],customerPoDate:[""],currency:["USD"],paymentTerm:["L/C 120 Days"],incoterm:["FOB"],shipmentMode:["SEA"],deliveryTerm:["Full Shipment Allowed"],shippingInstruction:[""],destination:[""],customerStyleNo:[""],idlStyleNo:[""],styleName:["Leather Jacket"],productCategory:["Women"],product:["Womens Leather Biker Jacket"],mainLeather:["Sheep Vegas 0.7-0.75 Finish M/G"],color:["Black"],customerColor:["33X Black"],gauge:["33X"],finish:[""],quantity:[50,u.required],unitPrice:[109,u.required],discount:[0],deliveryDate:["",u.required],paymentTerms:["Net 30"],status:["Draft"],remarks:[""],sizes:this.fb.array([]),productionInstructions:this.fb.array([])});ngOnInit(){this.initSizes(),this.initProduction(),this.route.params.subscribe(o=>{o.id?(this.isEditMode=!0,this.cpoId=o.id,this.loadCpoData(o.id)):this.generateCpoNo()})}get sizes(){return this.cpoForm.get("sizes")}initSizes(){this.sizesMaster.forEach(m=>{this.sizes.push(this.fb.group({size:[m],orderQty:[20],extraQty:[0],finalQty:[{value:20,disabled:!0}]}))}),this.calculateSizeFinalQty()}calculateSizeFinalQty(){this.sizes.controls.forEach(o=>{o.valueChanges.subscribe(()=>{let m=Number(o.get("orderQty")?.value)||0,r=Number(o.get("extraQty")?.value)||0;o.get("finalQty")?.setValue(m+r,{emitEvent:!1})})})}applyExtraQtyPercent(){let o=this.cpoForm.get("quantity")?.value||0,m=this.cpoForm.get("discount")?.value||0,r=Math.round(o*m/100),a=Math.floor(r/this.sizes.length);this.sizes.controls.forEach(c=>{let b=c.get("orderQty")?.value||0;c.get("extraQty")?.setValue(a),c.get("finalQty")?.setValue(b+a)})}get productionInstructions(){return this.cpoForm.get("productionInstructions")}initProduction(){this.addProductionRow()}addProductionRow(){this.productionInstructions.push(this.fb.group({process:[""],instruction:[""]}))}removeProductionRow(o){this.productionInstructions.length>1&&this.productionInstructions.removeAt(o)}generateCpoNo(){let o="CPO"+new Date().getTime().toString().slice(-6);this.cpoForm.patchValue({cpoNo:o})}loadCpoData(o){let m={cpoNo:"CPO001",cpoDate:"2024-01-15",merchandiser:"John Doe",customer:"Acme Corp",styleNo:"STL001",description:"Leather Jacket",color:"Red",size:"M",quantity:100,unitPrice:50,discount:5,deliveryDate:"2024-02-15",paymentTerms:"Net 30",status:"Active",remarks:"Premium quality leather"};this.cpoForm.patchValue(m)}getTotalAmount(){let o=this.cpoForm.get("quantity")?.value||0,m=this.cpoForm.get("unitPrice")?.value||0,r=this.cpoForm.get("discount")?.value||0;return o*m*(1-r/100)}onSubmit(){if(this.cpoForm.invalid){this.cpoForm.markAllAsTouched();return}console.log(this.cpoForm.getRawValue())}onCancel(){this.router.navigate(["/cpo"])}goBackToList(){this.router.navigate(["/cpo"])}onReset(){this.isEditMode?this.loadCpoData(this.cpoId):(this.cpoForm.reset({paymentTerms:"Net 30",status:"Draft"}),this.generateCpoNo())}static \u0275fac=function(m){return new(m||l)};static \u0275cmp=N({type:l,selectors:[["app-cpo-form"]],decls:259,vars:13,consts:[[1,"container-fluid","mt-4","mb-5"],[1,"card","shadow-sm"],[1,"card-header","bg-dark","text-white"],[1,"mb-0"],[1,"fas","fa-file-invoice"],[1,"card-body"],[3,"formGroup"],[1,"section-header","mb-3"],[1,"bg-light","p-2","border-start","border-4","border-primary"],[1,"fas","fa-info-circle"],[1,"row","mb-3"],[1,"col-md-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","cpoNo","placeholder","e.g., CPO001","readonly","",1,"form-control"],["type","date","formControlName","cpoDate",1,"form-control"],["type","text","formControlName","merchandiser","placeholder","Enter merchandiser name",1,"form-control"],["type","text","formControlName","customer","placeholder","Enter customer name",1,"form-control"],[1,"section-header","mb-3","mt-4"],[1,"row","mb-3","g-3"],["formControlName","orderType",1,"form-control"],["formControlName","subOrderType",1,"form-control"],["formControlName","season",1,"form-control"],["formControlName","selection",1,"form-control"],["formControlName","customerPoNo",1,"form-control"],["type","date","formControlName","customerPoDate",1,"form-control"],["formControlName","currency",1,"form-control"],["formControlName","paymentTerm",1,"form-control"],[1,"col-md-4"],["formControlName","incoterm",1,"form-control"],["formControlName","shipmentMode",1,"form-control"],["formControlName","deliveryTerm",1,"form-control"],[1,"col-md-6"],["formControlName","shippingInstruction",1,"form-control"],["formControlName","destination",1,"form-control"],[1,"bg-light","p-2","border-start","border-4","border-success"],[1,"fas","fa-shirt"],[1,"row","mb-3","g-2"],["formControlName","customerStyleNo",1,"form-control"],["formControlName","idlStyleNo",1,"form-control"],["formControlName","styleName",1,"form-control"],["formControlName","productCategory",1,"form-control"],["formControlName","product",1,"form-control"],["formControlName","mainLeather",1,"form-control"],["formControlName","color",1,"form-control"],["formControlName","customerColor",1,"form-control"],["formControlName","gauge",1,"form-control"],["formControlName","finish",1,"form-control"],[1,"bg-light","p-2","border-start","border-4","border-warning"],[1,"fas","fa-boxes"],["type","number","formControlName","quantity","placeholder","0","min","1",1,"form-control"],["type","number","step","0.01","formControlName","unitPrice","placeholder","0.00","min","0",1,"form-control"],["type","text","disabled","",1,"form-control",3,"value"],["type","number","step","0.01","formControlName","discount","placeholder","0","min","0","max","100",1,"form-control"],["type","date","formControlName","deliveryDate",1,"form-control"],["formControlName","paymentTerms",1,"form-control"],["value",""],["value","Net 30"],["value","Net 60"],["value","Advance"],["value","COD"],["formControlName","status",1,"form-control"],["value","Draft"],["value","Active"],["value","Completed"],["value","Cancelled"],["type","text","formControlName","remarks","placeholder","Additional notes",1,"form-control"],["formArrayName","sizes",1,"table","table-hover","table-fixed"],[1,"table-dark","sticky-header"],[3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],["formArrayName","productionInstructions",1,"table","table-hover","table-fixed"],["width","25%"],["width","80"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"row","mt-4"],[1,"col-md-12"],["type","button","title","Back to List",1,"btn","btn-outline-secondary","me-2",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",1,"btn","btn-primary","me-2",3,"click"],[1,"fas","fa-save"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],[1,"fas","fa-redo"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-times-circle"],[3,"formGroupName"],["formControlName","size","readonly","",1,"form-control"],["type","number","formControlName","orderQty",1,"form-control"],["type","number","formControlName","extraQty",1,"form-control"],["type","number","formControlName","finalQty","readonly","",1,"form-control","bg-light"],["formControlName","process",1,"form-control"],["formControlName","instruction",1,"form-control"],[1,"text-center"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-remove"]],template:function(m,r){if(m&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),i(4,"i",4),n(5),e()(),t(6,"div",5)(7,"form",6)(8,"div",7)(9,"h6",8),i(10,"i",9),n(11," CPO Header Details"),e()(),t(12,"div",10)(13,"div",11)(14,"label",12),n(15,"CPO No "),t(16,"span",13),n(17,"*"),e()(),i(18,"input",14),e(),t(19,"div",11)(20,"label",12),n(21,"CPO Date "),t(22,"span",13),n(23,"*"),e()(),i(24,"input",15),p(25,$,2,0,"small",13),e(),t(26,"div",11)(27,"label",12),n(28,"Merchandiser "),t(29,"span",13),n(30,"*"),e()(),i(31,"input",16),p(32,ee,2,0,"small",13),e(),t(33,"div",11)(34,"label",12),n(35,"Customer "),t(36,"span",13),n(37,"*"),e()(),i(38,"input",17),p(39,te,2,0,"small",13),e()(),t(40,"div",18)(41,"h6",8),i(42,"i",9),n(43," Order & Commercial Details"),e()(),t(44,"div",19)(45,"div",11)(46,"label"),n(47,"Order Type"),e(),i(48,"input",20),e(),t(49,"div",11)(50,"label"),n(51,"Sub Order Type"),e(),i(52,"input",21),e(),t(53,"div",11)(54,"label"),n(55,"Season"),e(),i(56,"input",22),e(),t(57,"div",11)(58,"label"),n(59,"Selection"),e(),i(60,"input",23),e(),t(61,"div",11)(62,"label"),n(63,"Customer PO #"),e(),i(64,"input",24),e(),t(65,"div",11)(66,"label"),n(67,"Customer PO Date"),e(),i(68,"input",25),e(),t(69,"div",11)(70,"label"),n(71,"Currency"),e(),i(72,"input",26),e(),t(73,"div",11)(74,"label"),n(75,"Payment Term"),e(),i(76,"input",27),e(),t(77,"div",28)(78,"label"),n(79,"Incoterm"),e(),i(80,"input",29),e(),t(81,"div",28)(82,"label"),n(83,"Mode of Shipment"),e(),i(84,"input",30),e(),t(85,"div",28)(86,"label"),n(87,"Delivery Term"),e(),i(88,"input",31),e(),t(89,"div",32)(90,"label"),n(91,"Shipping Instruction"),e(),i(92,"input",33),e(),t(93,"div",32)(94,"label"),n(95,"Destination (Port of Discharge)"),e(),i(96,"input",34),e()(),t(97,"div",18)(98,"h6",35),i(99,"i",36),n(100," Style & Product Details"),e()(),t(101,"div",37)(102,"div",28)(103,"label"),n(104,"Customer Model / Style No"),e(),i(105,"input",38),e(),t(106,"div",28)(107,"label"),n(108,"IDL Model / Style No"),e(),i(109,"input",39),e(),t(110,"div",28)(111,"label"),n(112,"Customer Style Name"),e(),i(113,"input",40),e(),t(114,"div",28)(115,"label"),n(116,"Product Category"),e(),i(117,"input",41),e(),t(118,"div",28)(119,"label"),n(120,"Product"),e(),i(121,"input",42),e(),t(122,"div",28)(123,"label"),n(124,"Main Leather"),e(),i(125,"input",43),e(),t(126,"div",11)(127,"label"),n(128,"Color"),e(),i(129,"input",44),e(),t(130,"div",11)(131,"label"),n(132,"Customer Color"),e(),i(133,"input",45),e(),t(134,"div",11)(135,"label"),n(136,"Gauge"),e(),i(137,"input",46),e(),t(138,"div",11)(139,"label"),n(140,"Finish"),e(),i(141,"input",47),e()(),t(142,"div",18)(143,"h6",48),i(144,"i",49),n(145," Order Details"),e()(),t(146,"div",10)(147,"div",11)(148,"label",12),n(149,"Quantity "),t(150,"span",13),n(151,"*"),e()(),i(152,"input",50),p(153,ne,2,0,"small",13),e(),t(154,"div",11)(155,"label",12),n(156,"Unit Price "),t(157,"span",13),n(158,"*"),e()(),i(159,"input",51),p(160,ie,2,0,"small",13),e(),t(161,"div",11)(162,"label",12),n(163,"Total Amount"),e(),i(164,"input",52),D(165,"currency"),e(),t(166,"div",11)(167,"label",12),n(168,"Discount %"),e(),i(169,"input",53),e()(),t(170,"div",10)(171,"div",11)(172,"label",12),n(173,"Delivery Date "),t(174,"span",13),n(175,"*"),e()(),i(176,"input",54),p(177,oe,2,0,"small",13),e(),t(178,"div",11)(179,"label",12),n(180,"Payment Terms"),e(),t(181,"select",55)(182,"option",56),n(183,"Select Terms"),e(),t(184,"option",57),n(185,"Net 30"),e(),t(186,"option",58),n(187,"Net 60"),e(),t(188,"option",59),n(189,"Advance Payment"),e(),t(190,"option",60),n(191,"Cash on Delivery"),e()()(),t(192,"div",11)(193,"label",12),n(194,"Status"),e(),t(195,"select",61)(196,"option",62),n(197,"Draft"),e(),t(198,"option",63),n(199,"Active"),e(),t(200,"option",64),n(201,"Completed"),e(),t(202,"option",65),n(203,"Cancelled"),e()()(),t(204,"div",11)(205,"label",12),n(206,"Remarks"),e(),i(207,"input",66),e()(),t(208,"div",18)(209,"h6",8),i(210,"i",9),n(211," Size Breakup "),e()(),t(212,"table",67)(213,"thead",68)(214,"tr")(215,"th"),n(216,"Size"),e(),t(217,"th"),n(218,"Order Qty"),e(),t(219,"th"),n(220,"Extra Qty"),e(),t(221,"th"),n(222,"Final Qty"),e()()(),t(223,"tbody"),v(224,re,9,1,"tr",69),e()(),t(225,"button",70),s("click",function(){return r.applyExtraQtyPercent()}),n(226," Apply Extra Qty % "),e(),t(227,"div",18)(228,"h6",8),i(229,"i",9),n(230," Production Instruction"),e()(),t(231,"table",71)(232,"thead",68)(233,"tr")(234,"th",72),n(235,"Process"),e(),t(236,"th"),n(237,"Instruction"),e(),t(238,"th",73),n(239,"Action"),e()()(),t(240,"tbody"),v(241,le,8,1,"tr",69),e()(),t(242,"button",74),s("click",function(){return r.addProductionRow()}),i(243,"i",75),n(244," Add Row "),e(),t(245,"div",76)(246,"div",77)(247,"button",78),s("click",function(){return r.goBackToList()}),i(248,"i",79),n(249," Back "),e(),t(250,"button",80),s("click",function(){return r.onSubmit()}),i(251,"i",81),n(252," Save "),e(),t(253,"button",82),s("click",function(){return r.onReset()}),i(254,"i",83),n(255," Reset "),e(),t(256,"button",84),s("click",function(){return r.onCancel()}),i(257,"i",85),n(258," Cancel "),e()()()()()()()),m&2){let a,c,b,C,h,E;d(5),P(" ",r.isEditMode?"Edit CPO":"Create Purchase Order"),d(2),y("formGroup",r.cpoForm),d(18),f((a=r.cpoForm.get("cpoDate"))!=null&&a.touched&&((a=r.cpoForm.get("cpoDate"))!=null&&a.invalid)?25:-1),d(7),f((c=r.cpoForm.get("merchandiser"))!=null&&c.touched&&((c=r.cpoForm.get("merchandiser"))!=null&&c.invalid)?32:-1),d(7),f((b=r.cpoForm.get("customer"))!=null&&b.touched&&((b=r.cpoForm.get("customer"))!=null&&b.invalid)?39:-1),d(114),f((C=r.cpoForm.get("quantity"))!=null&&C.touched&&((C=r.cpoForm.get("quantity"))!=null&&C.invalid)?153:-1),d(7),f((h=r.cpoForm.get("unitPrice"))!=null&&h.touched&&((h=r.cpoForm.get("unitPrice"))!=null&&h.invalid)?160:-1),d(4),y("value",T(165,11,r.getTotalAmount())),d(13),f((E=r.cpoForm.get("deliveryDate"))!=null&&E.touched&&((E=r.cpoForm.get("deliveryDate"))!=null&&E.invalid)?177:-1),d(47),y("ngForOf",r.sizes.controls),d(17),y("ngForOf",r.productionInstructions.controls)}},dependencies:[Y,w,U,X,I,R,J,z,q,j,W,V,G,L,B,K,M,O,k],styles:[".card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:12px 12px 0 0;padding:16px 20px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:600;letter-spacing:.5px;color:#fff;margin:0;font-size:1.1rem;display:flex;align-items:center;gap:8px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{font-size:.95rem;padding:12px}"]})};export{Z as CpoForm};
